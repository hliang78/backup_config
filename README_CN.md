### README

#### 1. 程序简介
这个程序的主要任务是帮你**自动备份网络设备的配置**。它通过读取一个包含设备信息的JSON文件，连接到指定的网络设备，并执行你预先定义好的命令来获取设备的当前配置。然后，它会把这些配置保存到你指定的输出目录中，方便你以后查看或恢复。

##### 它能帮你做什么？
- **自动备份**：你可以设置定期或手动运行这个程序，它会自动连接到多个网络设备并备份配置，省去你手动操作的麻烦，还能减少出错的可能性。
- **多设备兼容**：无论是路由器、交换机还是防火墙，它都能支持多种品牌和型号的设备，确保你能备份不同设备的配置。
- **多种连接方式**：支持SSH和Telnet两种连接方式，适应不同的网络环境和安全需求。
- **自定义命令**：你可以在JSON配置文件中指定需要执行的命令，灵活获取你想要的配置信息或设备状态。
- **智能管理备份**：备份结果会按日期分类保存，并以设备名称命名文件，方便你随时查找和管理。

##### 适用场景
- **日常维护**：网络管理员可以定期用它备份设备配置，万一设备出问题或配置被误改，能快速恢复。
- **变更管理**：在进行网络变更之前，先备份一下现有配置，作为变更前的快照，方便后续对比或回滚。
- **审计与合规**：满足企业内部或外部的审计要求，提供完整的配置历史记录，确保符合相关法规和标准。
- **灾难恢复**：当网络出现重大故障时，可以从备份文件中快速恢复设备配置，减少业务中断时间。

#### 2. 配置文件格式
配置文件是JSON格式的，下面是一个示例：

```json
[
    {
        "name": "device1",
        "device_type": "IOS",
        "ip": "192.168.1.1",
        "username": "admin",
        "password": "password",
        "auth_pass": "secret",
        "ssh": true,
        "commands": ["show version", "show running-config"]
    }
]
```

#### 3. 命令行参数
程序支持以下命令行参数：
- `-json`：指定JSON配置文件的路径，默认是`data.json`。
- `-output`：指定输出目录，默认是`./output/`。
- `-filter`：指定过滤条件，可以多次使用来添加多个过滤条件。比如：`--filter conf --filter shut`。

#### 4. 如何运行程序
在终端中输入以下命令来启动程序：

```bash
config_backup -json=path/to/config.json -output=path/to/output/ --filter conf --filter shut
```

#### 5. 输出结果
程序会根据当前日期创建一个子目录（比如`20231010`），然后把每个设备的命令输出保存为文本文件，文件名就是设备名称加上`.txt`后缀，存放在你指定的输出目录中。

#### 6. 支持的设备类型
目前支持以下设备类型：
- IOS
- SRX
- ASA
- HuaWei
- Comware
- F5
- HillStone
- NEXUS

如果你尝试使用不支持的设备类型，程序会提示错误并跳过该设备。

#### 7. 错误处理
- 如果读取或解析JSON文件失败，程序会停止运行并提示错误。
- 如果创建输出目录失败，程序也会停止并提示错误。
- 如果设备类型不支持，程序会跳过该设备并提示错误。
- 如果执行命令失败，程序会继续处理下一个设备，并提示错误。

#### 8. 注意事项
- 确保配置文件中的IP地址、用户名和密码是正确的。
- 确保目标设备允许通过SSH或Telnet连接。
- 确保输出目录路径存在，并且你有写权限。

#### 9. 获取帮助
如果你遇到任何问题，或者需要进一步的帮助，随时联系我们的技术支持团队。

---